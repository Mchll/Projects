#include <stdio.h>
#include <stdlib.h>

void f(int address_main, int address_f1, int data[]) {
	int i;
	for(i = 0; i < 40; ++i) {
		printf("i=%d, diff=%p\n", i, data[i] - address_main);
	}
	data[12] = address_f1;
}

int f1(int y) {
    printf("EXPLOIT");
	return y + 1;
}

int main()
{
    int val = 0, y = 1;
    int address_main = &main;
	int address_f1 = &f1;
    int data[5] = {0};
	printf("&main = %p\n", &main);
	printf("&f1   = %p\n", &f1);
	printf("&f    = %p\n", &f);
	f(address_main, address_f1, data);
    val = f1(y);
	return 0;
}
